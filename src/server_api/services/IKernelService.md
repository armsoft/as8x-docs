---
layout: page
title: "IKernelService սերվիս" 
tags: Accounting
---

## Բովանդակություն

- [Մեթոդներ](#մեթոդներ)
  - [GetExchangeRate](#getexchangerate)
  - [GetRem](#getrem)
  - [GetRemHI2](#getremhi2)
  - [GetTurn](#getturn)
  - [GetTurnHI2](#getturnhi2)
  - [GetTurnFull](#getturnfull)
  - [GetTurnBetween](#getturnbetween)
  - [LastOpDate](#lastopdate)
  - [LastOpDate2](#lastopdate2)
  - [LastHI2OpDate](#lasthi2opdate)
  - [LastHI2OpDate](#lasthi2opdate-1)
  - [UserPositionAndMask](#userpositionandmask)

## Մեթոդներ

### GetExchangeRate

```c#
public Task<ExchangeRate> GetExchangeRate(string codCurrency, 
                                          DateTime date, 
                                          DateTime? maxCreationDate = null)
```

Վերադարձնում է արտարժույթի փոխարժեքը։ Եթե նշված ամսաթվի արտարժույթը բացակայում է, ապա բերվում է արտարժույթի վերջին առկա տվյալը։

**Պարամետրեր**

* `codCurrency` - Արտարժույթի կոդ։
* `date` - Փոխարժեքի նշանակման ամսաթիվ/ժամանակ։
* `maxCreationDate` - Փոխանցված լինելու դեպքում մեթոդը փնտրում է փոխարժեք, որի նշանակման ամսաթիվը չի գերազանցում փոխանցված ամսաթիվը:

### GetRem

```c#
public Task<(decimal CRem, decimal NCRem)> GetRem(string accounting, 
                                                  int isn, 
                                                  DateTime? remDate = null)
```

Վերադարձնում է`
* `CRem` - Հաշվառում օբյեկտի մնացորդը հաշվի արտարժույթով։
* `NCRem` - Հաշվառում օբյեկտի մնացորդը դրամային  արտարժույթով։

**Պարամետրեր**

* `accounting` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `remDate` - Մնացորդը բերելու ամսաթիվը։ Եթե պարամետրը փոխանցված չէ, ապա բերվում է վերջնական մնացորդը։

### GetRemHI2

```c#
public Task<(decimal CRem, decimal NCRem)> GetRemHI2(string accounting, 
                                                     int isn = -1, 
                                                     int isnGl = -1, 
                                                     DateTime? remDate = null)
```

Վերադարձնում է հաշվառում օբյեկտի մնացորդը [HI2](https://armsoft.github.io/as4x-docs/HTM/ProgrGuide/Database/Hi2.html) արտարժույթային  (`CRem`) և դրամային (`NCRem`) հաշվառումների համար նշված ամսաթվի դրությամբ։ Մնացորդը կա՛մ գումարային ըստ բոլոր կուտակող օբյեկտների է, կամ միայն `isnGl`-ով փոխանցվածի։

**Պարամետրեր**

* `accounting` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառվող հիմնական օբյեկտի ներքին նույնականացման համար։
* `isnGl` - Հաշվառվող կուտակող օբյեկտի ներքին նույնականացման համար։
* `remDate` - Մնացորդը բերելու ամսաթիվը։ Եթե պարամետրը փոխանցված չէ, ապա բերվում է վերջնական մնացորդը։

### GetTurn

```c#
public Task<(decimal DbTurn, decimal DbTurnAMD, decimal CrTurn, decimal CrTurnAMD)> GetTurn(string accounting, 
                                                                                            int isn, 
                                                                                            DateTime startDate, 
                                                                                            DateTime endDate, 
                                                                                            string codeOperList = "")
```

Վերադարձնում է հաշվառում օբյեկտի դեբետային և կրեդիտային շրջանառության արժեքները տրված ժամանակաշրջանի համար։

* `DbTurn` - Հաշվառող օբյեկտի դեբետային շրջանառության արժեքը հաշվի արտարժույթով։
* `DbTurnAMD` - Հաշվառող օբյեկտի դեբետային շրջանառության արժեքը դրամային արտարժույթով։
* `CrTurn` - Հաշվառող օբյեկտի կրեդիտային շրջանառության արժեքը հաշվի արտարժույթով։
* `DbTurnAMD` - Հաշվառող օբյեկտի կրեդիտային շրջանառության արժեքը դրամային արտարժույթով։

**Պարամետրեր**

* `accounting` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `startDate` - Ժամանակաշրջանի սկզբի ամսաթիվ։
* `endDate` - ժամանակաշրջանի վերջին ամսաթիվ։
* `codeOperList` - Գործողությունների կոդերի ցանկ։ Եթե ցանկը սկսվում է “+” նշանով, ապա հաշվի են առնվում գործողությունների բոլոր կոդերը, որոնք թվարկվում են նրանից հետո։ 
“-“ նշանի դեպքում անտեսվում են այն գործողությունները, որոնց կոդերը թվարկված են ցանկի մեջ։ 
Գործողությունների կոդերը թվարկվում են մեկը մյուսի հետևից բացատների միջոցով։ 
Ցանկը նաև կարող է պարունակել առանց նշանի միակ տարր։

### GetTurnHI2

```c#
public Task<(decimal DbTurn, decimal DbTurnAMD, decimal CrTurn, decimal CrTurnAMD)> GetTurnHI2(string accounting, 
                                                                                               int isn, 
                                                                                               int isnGl, 
                                                                                               DateTime startDate, 
                                                                                               DateTime endDate, 
                                                                                               string codeOper = "", 
                                                                                               int baseIsn = -1)
```

Վերադարձնում է հաշվառում օբյեկտի դեբետային և կրեդիտային շրջանառության արժեքները ըստ տրված կուտակող օբյեկտի տրված ժամանակաշրջանի համար։

* `DbTurn` - Հաշվառող օբյեկտի դեբետային շրջանառության արժեքը հաշվի արտարժույթով։
* `DbTurnAMD` - Հաշվառող օբյեկտի դեբետային շրջանառության արժեքը դրամային արտարժույթով։
* `CrTurn` - Հաշվառող օբյեկտի կրեդիտային շրջանառության արժեքը հաշվի արտարժույթով։
* `DbTurnAMD` - Հաշվառող օբյեկտի կրեդիտային շրջանառության արժեքը դրամային արտարժույթով։

**Պարամետրեր**

* `accounting` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `isnGl` - Կուտակող օբյեկտի ներքին նույնականացման համար։
* `startDate` - Ժամանակաշրջանի սկզբի ամսաթիվ։
* `endDate` - ժամանակաշրջանի վերջին ամսաթիվ։
* `codeOper` - Հաշվառման գործողության կոդը, որի շրջանառությունները կվերադարձվի։
* `baseIsn` - Հիմքային փաստաթղթի ներքին նույնականացման համար։ 

### GetTurnFull

```c#
public Task<(decimal DbTurn, decimal DbTurnAMD, 
            decimal CrTurn, decimal CrTurnAMD, decimal Rem, 
            decimal RemAMD, decimal StartRem, decimal StartRemAMD)> GetTurnFull(string accounting, 
                                                                                int isn, 
                                                                                DateTime startDate, 
                                                                                DateTime endDate)
```

Վերադարձնում է հաշվառում օբյեկտի դեբետային և կրեդիտային շրջանառության արժեքները տրված ժամանակաշրջանի համար, ինչպես նաև սկզբնական և վերջնական մնացորդները։

* `DbTurn` - Հաշվառող օբյեկտի դեբետային շրջանառության արժեքը հաշվի արտարժույթով։
* `DbTurnAMD` - Հաշվառող օբյեկտի դեբետային շրջանառության արժեքը դրամային արտարժույթով։
* `CrTurn` - Հաշվառող օբյեկտի կրեդիտային շրջանառության արժեքը հաշվի արտարժույթով։
* `DbTurnAMD` - Հաշվառող օբյեկտի կրեդիտային շրջանառության արժեքը դրամային արտարժույթով։
* `Rem` - Հաշվառում օբյեկտի վերջնական մնացորդը հաշվի արտարժույթով։
* `RemAMD` - Հաշվառում օբյեկտի վերջնական մնացորդը դրամային արտարժույթով։
* `StartRem` - Հաշվառում օբյեկտի սկզբնական մնացորդը հաշվի արտարժույթով։
* `NCRem` - Հաշվառում օբյեկտի մնացորդը դրամային արտարժույթով։

**Պարամետրեր**

* `accounting` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `startDate` - Ժամանակաշրջանի սկզբի ամսաթիվ։
* `endDate` - ժամանակաշրջանի վերջին ամսաթիվ։

### GetTurnBetween

```c#
public Task<List<(DateTime Date, decimal DbTurn, 
                  decimal DbTurnAMD, decimal CrTurn, decimal CrTurnAMD)>> GetTurnBetween(string accounting, 
                                                                                         int isn, 
                                                                                         DateTime startDate, 
                                                                                         DateTime endDate, 
                                                                                         string codeOper = "", 
                                                                                         bool bNotShowSameClAccTurn = false)
```

Վերադարձնում է հաշվառվող օբյեկտի ամենօրյա շրջանառությունների արժեքների ցուցակը նշված ժամանակահատվածի համար, որտեղ

* `Date` - Այն ամսաթիվը, որի համար նշվում են շրջանառությունները։
* `DbTurn` - Դեբետային շրջանառությունը նշված ամսաթվով հաշվի արտարժույթով։
* `DbTurnAMD` - Դեբետային շրջանառությունը նշված ամսաթվով դրամային արտարժույթով։
* `CrTurn` - Կրեդիտային շրջանառությունը նշված ամսաթվով հաշվի արտարժույթով։
* `CrTurnAMD` - Կրեդիտային շրջանառությունը նշված ամսաթվով դրամային արտարժույթով։

**Պարամետրեր**

* `accounting` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `startDate` - Ժամանակաշրջանի սկզբի ամսաթիվ։
* `endDate` - ժամանակաշրջանի վերջին ամսաթիվ։
* `codeOper` - Հաշվառման գործողության կոդը, որի շրջանառությունները կվերադարձվի։
* `bNotShowSameClAccTurn` - ??

### LastOpDate

```c#
public Task<DateTime?> LastOpDate(string accCode, int isn, 
                                  DateTime? upToDate, string op = "", 
                                  int discardISN = -1)
```

Վերադարձնում է հաշվառվող օբյեկտի համար նշանակված վերջին գործառույթի ամսաթիվը, որը ստեղծվել է հաշվառման նշված կոդով մինչև նշված ամսաթիվը ներառյալ։

**Պարամետրեր**

* `accCode` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառվող օբյեկտի ներքին նույնականացմամ համար։
* `upToDate` - Ամսաթիվը, մինչև որը կատարվում է որոնումը։ Եթե պարամետրը տրված չէ, ապա վերադառնում է տվյալ հաշվառման մեջ վերջին գործառույթի ամսաթիվը։
* `op` - 	Հաշվառման գործողություն, որով անցկացվում է որոնումը։
* `discardISN` - Փաստաթղթի ներքին նույնականացման համար, որի գործարքները չեն դիտարկվում։

### LastOpDate2

```c#
public Task<DateTime?> LastOpDate2(string accountings, int isn, 
                                   DateTime? upToDate, bool inOp = true, 
                                   string op = "", string dbcr = "")
```

Վերադարձնում է հաշվառվող օբյեկտի համար նշանակված վերջին գործառույթի ամսաթիվը, որը ստեղծվել է հաշվառման նշված կոդով մինչև նշված ամսաթիվը ներառյալ։

Ի տարբերություն [LastOpDate](#lastopdate) մեթոդի, այս մեթոդը կարող է ֆիլտրել ներառող կամ բացառող գործողությունների կոդերով։

**Պարամետրեր**

* `accountings` - Հաշվառումների կոդերի ցուցակ:
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `upToDate` - Ամսաթիվը, մինչև որը կատարվում է որոնումը։ Եթե պարամետրը տրված չէ, ապա վերադառնում է տվյալ հաշվառման մեջ վերջին գործառույթի ամսաթիվը։
* `inOp` - Ցույց է տալիս, թե արդյոք որոնվող գործողությունը պետք է լինի `op`-ից, թե չլինի `op`-ից։
* `op` - Հաշվառման գործողությունների ցանկ, որով անցկացվում է որոնումը։ 
Գործողությունների կոդերը թվարկվում են մեկը մյուսի հետևից ստորակետերի միջոցով։ 
Ցանկը նաև կարող է պարունակել միակ տարր։
* `dbcr` - Դեբետային("D") կամ կրեդիտային("C") գործողությունների որոնման ֆիլտր։ Լռության դեպքում դիտվում են բոլոր գործողությունները։

### LastHI2OpDate

```c#
public Task<DateTime?> LastHI2OpDate(string accCode, int isn = -1, 
                                     int glIsn = -1, DateTime? upToDate = null, 
                                     string op = "")
```

Վերադարձնում է հաշվառվող օբյեկտի համար նշանակված վերջին [HI2](https://armsoft.github.io/as4x-docs/HTM/ProgrGuide/Database/Hi2.html) գործառույթի ամսաթիվը, որը ստեղծվել է հաշվառման նշված կոդով մինչև նշված ամսաթիվը ներառյալ։

**Պարամետրեր**

* `accCode` - Հաշվառման կոդ (ներքին անուն):
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `glIsn` - Կուտակող օբյեկտի ներքին նույնականացման համար։
* `upToDate` - Ամսաթիվը, մինչև որը կատարվում է որոնումը։ Եթե պարամետրը տրված չէ, ապա վերադառնում է տվյալ հաշվառման մեջ վերջին գործառույթի ամսաթիվը։
* `op` - Հաշվառման գործողություն, որով անցկացվում է որոնումը։

### LastHI2OpDate

```c#
public Task<DateTime?> LastHI2OpDate(List<string> accCodes, int isn = -1, 
                                     int glIsn = -1, DateTime? upToDate = null, 
                                     string op = "")
```

Վերադարձնում է հաշվառվող օբյեկտի համար նշանակված վերջին [HI2](https://armsoft.github.io/as4x-docs/HTM/ProgrGuide/Database/Hi2.html) գործառույթի ամսաթիվը, որը ստեղծվել է հաշվառման նշված կոդով մինչև նշված ամսաթիվը ներառյալ։

**Պարամետրեր**

* `accCodes` - Հաշվառումների կոդերի զանգված:
* `isn` - Հաշվառման օբյեկտի ներքին նույնականացման համար։
* `glIsn` - Կուտակող օբյեկտի ներքին նույնականացման համար։
* `upToDate` - Ամսաթիվը, մինչև որը կատարվում է որոնումը։ Եթե պարամետրը տրված չէ, ապա վերադառնում է տվյալ հաշվառման մեջ վերջին գործառույթի ամսաթիվը։
* `op` - Հաշվառման գործողություն, որով անցկացվում է որոնումը։

### UserPositionAndMask

```c#
public void UserPositionAndMask(out byte number, out byte mask, short suid = -1)
```

Վերադարձնում է համակարգի օգտագործողի դիրքի համարը և դիմակը։ Նախատեսված է օգտագործողի իրավասությունների ստուգման համար։

**Պարամետրեր**

* `number` - Վերադարձնում է օգտագործողի դիրքի համարը։
* `mask` - Վերադարձնում է օգտագործողի դիմակը։
* `suid` - Համակարգի օգտագործողի ներքին համարը, որի համար վերադարձվելու են տվյալները։ Չփոխանցելու դեպքում վերադարձվում են ընթացիկ օգտագործողի համար։
