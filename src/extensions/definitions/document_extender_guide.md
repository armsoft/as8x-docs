---
layout: page
title: "Փաստաթղթի իրադարձությունների ընդլայնման ձեռնարկ" 
sublinks:
- { title: ".as ֆայլի ստեղծում", ref: as-ֆայլի-ստեղծում }
- { title: ".cs ֆայլի ստեղծում", ref: cs-ֆայլի-ստեղծում }
- { title: "Ֆայլերի ներմուծում", ref: ֆայլերի-ներմուծում }
---

## Բովանդակություն

- [Ներածություն](#ներածություն)
- [.as ֆայլի ստեղծում](#as-ֆայլի-ստեղծում)
- [.cs ֆայլի ստեղծում](#cs-ֆայլի-ստեղծում)
- [Ֆայլերի ներմուծում](#ֆայլերի-ներմուծում)

## Ներածություն

8X համակարգում նախատեսված է հնարավորություն ընդլայնելու համակարգում առկա փաստաթղթերի մշակման գործընթացը ավելացնելով լրացուցիչ ստուգումներ, իրականացնելով դաշտերի ավտոմատ լրացում, ինչպես նաև կատարելով ցանկացած այլ գործողություններ, որոնք պետք է կատարվեն փաստաթղթի ստեղծման, խմբագրման կամ հեռացման ընթացքում։

Ստորև ձեռնարկում նկարագրած է փաստաթղթի համար լրացուցիչ մշակումներ ավելացնելու քայլերը։  

Փաստաթղթի ընդլայնման ամբողջական օրինակը տե՛ս՝ ["Երկիր" փաստաթղթի ընդլայնման օրինակ](../examples/document_extender_country.md) էջում։

Տվյալների աղբյուրի ընդլայնման համար անհրաժեշտ է ստեղծել `DOCUMENTEXTENDER` նկարագրությունը `.as` ֆայլում և C# դասը `.cs` ֆայլում, որոնք հետագայում հարկավոր կլինի ներմուծել համակարգ SYSCON-ի միջոցով։

Ընդլայնման ֆայլերի ինչպես նաև `DocumentExtender` դասի նկարագրությունը հասանելի է [Փաստաթղթի ընդլայնման նկարագրություն](document_extender.md) բաժնում։

## .as ֆայլի ստեղծում

`.as` ֆայլը պարունակում է տվյալներ ընդլայնվող փաստաթղթի և ներմուծվող ընդլայնման վերաբերյալ։ 

``` as4x
DOCUMENTEXTENDER {
  NAME = "COUNTRY";
  CAPTION = "Երկիր փաստ. ընդլայնում";
  CAPTION = "Country doc extension";
  CSSOURCE = "CountryEx.cs";
};
```

Որտեղ՝
- `NAME` - ընդլայնվող փաստաթղթի ներքին անունը։ Այն պետք է համընկնի գոյություն ունեցող փաստաթղթի ներքին անվան հետ։
- `CAPTION` և `ECAPTION` - համակարգում արտացոլվող ընդլայնման հայերեն (ANSI կոդավորմամբ) և անգլերեն անվանումները։ 
- `CSSOURCE` - `.cs` ֆայլի անունը։ 

## .cs ֆայլի ստեղծում

Լրացուցիչ տրամաբանությունը անհրաժեշտ է նկարագրել C#-ով համապատասխան .cs ֆայլում։
.cs ֆայլում հարկավոր է ստեղծել class, որը ժառանգվում է [DocumentExtender](document_extender.md#documentextender-դաս) դասից։
Հարկավոր է նաև ավելացնել `[DocumentExtender]` ատրիբուտը։ Օրինակ՝

```c#
[DocumentExtender]
public class MyDocExtension : DocumentExtender
```

Նոր դասում կարելի է կատարել [ինյեկցիա](../../project/injection.md) սերվերային API-ներին հասանելություն ստանալու համար։

```c#
[DocumentExtender]
public class MyDocExtension : DocumentExtender
{
  private readonly IParametersService paramService;
    
  public MyDocExtension(IParametersService paramService)
  {
    this.paramService = paramService;
  }
}
```

Նոր դասը կարող է ընդլայնել `DocumentExtender` դասում նկարագրված մեթոդները։ 
Ամբողջական ցանկը տե՛ս [այստեղ](document_extender.md)։  
Մեթոդները ստանում են մշակվող փաստաթղթի օբյեկտը `sender` պարամետրում և լրացուցիչ տվյալներ `args` պարամետրում:

Ընդլայնված մեթոդներով հնարավոր է մշակման տարբեր փուլերում կատարել լրացված դաշտերի ստուգում, ավտոմատ լրացում, առաջացնել բացառություններ (exceptions) ընդհատելով փաստաթղթի մշակումը, ինչպես նաև կատարել ցանկացած այլ գործողություն, որ հնարավոր է կատարել փաստաթղթի [հիմնական իրադարձությունների ընթացքում](../../server_api/definitions/document.md)։ 

```c#
[DocumentExtender]
public class MyDocExtension : DocumentExtender
{
  //...

  public async override Task PreValidate(Document sender, ValidateEventArgs args)
  {
      
  }
  
  public override Task PostAction(Document sender, ActionEventArgs args)
  {

  }
}
```

## Ֆայլերի ներմուծում

.as և .cs ֆայլերը պատրաստ լինելուն պես անհրաժեշտ է **SYSCON**-ով համապատասխան .as ֆայլը ներմուծել համակարգ, ինչի արդյունքում .cs ֆայլը նույնպես կներմուծվի։ 

Նախքան Ներմուծումը տեղադրեք `.as` և `.cs` ֆայլերը config.as ֆայլում սահմանված BASEFOLDER պարամետրով ճանապարհով, այնուհետև գործարկելով SYSCON ծրագիրը ներմուծեք "Նկարագրությունների ներմուծում" հանգույցի ներքո արտացոլվող ֆայլը։
